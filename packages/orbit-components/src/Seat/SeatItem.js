// @flow
import React, { useMemo } from "react";

import useTheme from "../hooks/useTheme";
import { TYPES, SIZE_OPTIONS } from "./consts";
import randomID from "../utils/randomID";

import type { Props } from "./index";

const resolveFillColor = ({ type, theme, selected }) => {
  if (type === TYPES.LEGROOM)
    return selected ? theme.orbit.paletteBlueDark : theme.orbit.paletteBlueLight;
  if (type === TYPES.UNAVAILABLE) return theme.orbit.paletteCloudLight;
  return selected ? theme.orbit.paletteProductNormal : theme.orbit.paletteProductLight;
};

const resolveAccentColor = ({ type, theme }) => {
  if (type === TYPES.LEGROOM) return theme.orbit.paletteBlueLightActive;
  if (type === TYPES.UNAVAILABLE) return theme.orbit.paletteCloudLightActive;
  return theme.orbit.paletteProductLightActive;
};

const resolveTextColor = ({ type, theme }) => {
  if (type === TYPES.LEGROOM) return theme.orbit.paletteBlueDark;
  return theme.orbit.paletteProductDark;
};

const resolveCloseFill = ({ type, theme }) => {
  if (type === TYPES.LEGROOM) return theme.orbit.paletteBlueDarker;
  return theme.orbit.paletteProductDarker;
};

const SeatItem = ({ selected, type, label, size }: Props) => {
  const theme = useTheme();
  const randomIdSelectedNormal = useMemo(() => randomID("selectedIdNormal"), []);
  const randomIdSelectedSmall = useMemo(() => randomID("selectedIdSmall"), []);
  const randomCloseIconId = useMemo(() => randomID("randomCloseIconId"), []);

  if (selected && type === TYPES.UNAVAILABLE) return null;

  if (size === SIZE_OPTIONS.SMALL) {
    return selected ? (
      <>
        <path
          d="M1.20801 17C1.20801 12.0294 5.23745 8 10.208 8H23.208C28.1786 8 32.208 12.0294 32.208 17V39C32.208 40.6569 30.8649 42 29.208 42H4.20801C2.55115 42 1.20801 40.6569 1.20801 39V17Z"
          fill={resolveFillColor({ type, theme, selected })}
        />
        {label && type !== TYPES.UNAVAILABLE && (
          <text x="41.5%" y="66%" dominantBaseline="middle" textAnchor="middle">
            <tspan fontWeight="bold" fontSize="14px" fill={theme.orbit.paletteWhite}>
              {label}
            </tspan>
          </text>
        )}
        <circle cx="29.208" cy="9.99996" r="7.89474" fill={theme.orbit.paletteWhite} />
        <mask
          id={randomIdSelectedSmall}
          mask-type="alpha"
          maskUnits="userSpaceOnUse"
          x="20"
          y="1"
          width="18"
          height="18"
        >
          <path
            d="M29.2077 1.66699C33.7911 1.66699 37.5411 5.41699 37.5411 10.0003C37.5411 14.5837 33.7911 18.3337 29.2077 18.3337C24.6244 18.3337 20.8744 14.5837 20.8744 10.0003C20.8744 5.41699 24.6244 1.66699 29.2077 1.66699ZM33.0876 6.11094C32.7945 5.81826 32.3197 5.81861 32.027 6.11172L29.4432 8.69952L29.3904 8.7426C29.2609 8.8279 29.0851 8.81348 28.9713 8.69947L26.3888 6.11172C26.0961 5.81861 25.6212 5.81826 25.3281 6.11094L25.2609 6.18769C25.037 6.4815 25.059 6.90291 25.3273 7.1716L27.913 9.76202C28.0429 9.89214 28.0429 10.1028 27.913 10.233L25.3273 12.8237C25.0347 13.1168 25.035 13.5917 25.3281 13.8844C25.6212 14.1771 26.0961 14.1767 26.3888 13.8836L28.9713 11.2948C29.1021 11.1643 29.3132 11.1645 29.4432 11.2948L32.027 13.8836C32.3197 14.1767 32.7945 14.1771 33.0876 13.8844L33.1548 13.8076C33.3788 13.5138 33.3567 13.0924 33.0884 12.8237L30.5023 10.233C30.3724 10.1029 30.3724 9.89213 30.5023 9.762L33.0884 7.1716C33.3811 6.87849 33.3808 6.40361 33.0876 6.11094Z"
            fill={theme.orbit.paletteWhite}
          />
        </mask>
        <g mask={`url(#${randomIdSelectedSmall})`}>
          <path
            d="M29.2077 1.66699C33.7911 1.66699 37.5411 5.41699 37.5411 10.0003C37.5411 14.5837 33.7911 18.3337 29.2077 18.3337C24.6244 18.3337 20.8744 14.5837 20.8744 10.0003C20.8744 5.41699 24.6244 1.66699 29.2077 1.66699ZM33.0876 6.11094C32.7945 5.81826 32.3197 5.81861 32.027 6.11172L29.4432 8.69952L29.3904 8.7426C29.2609 8.8279 29.0851 8.81348 28.9713 8.69947L26.3888 6.11172C26.0961 5.81861 25.6212 5.81826 25.3281 6.11094L25.2609 6.18769C25.037 6.4815 25.059 6.90291 25.3273 7.1716L27.913 9.76202C28.0429 9.89214 28.0429 10.1028 27.913 10.233L25.3273 12.8237C25.0347 13.1168 25.035 13.5917 25.3281 13.8844C25.6212 14.1771 26.0961 14.1767 26.3888 13.8836L28.9713 11.2948C29.1021 11.1643 29.3132 11.1645 29.4432 11.2948L32.027 13.8836C32.3197 14.1767 32.7945 14.1771 33.0876 13.8844L33.1548 13.8076C33.3788 13.5138 33.3567 13.0924 33.0884 12.8237L30.5023 10.233C30.3724 10.1029 30.3724 9.89213 30.5023 9.762L33.0884 7.1716C33.3811 6.87849 33.3808 6.40361 33.0876 6.11094Z"
            fill={resolveCloseFill({ type, theme })}
          />
          <path d="M39.208 0H19.208V20.8333H39.208V0Z" fill={resolveCloseFill({ type, theme })} />
        </g>
        <circle cx="29.208" cy="10" r="9" stroke={theme.orbit.paletteWhite} strokeWidth="2" />
      </>
    ) : (
      <>
        <path
          d="M1.94592 10C1.94592 5.02944 5.97536 1 10.9459 1H23.9459C28.9165 1 32.9459 5.02944 32.9459 10V32C32.9459 33.6569 31.6028 35 29.9459 35H4.94592C3.28907 35 1.94592 33.6569 1.94592 32V10Z"
          fill={resolveFillColor({ type, theme, selected })}
          stroke={resolveAccentColor({ type, theme })}
          strokeWidth="2"
        />
        <path
          d="M0.945923 32H33.9459C33.9459 34.2091 32.1551 36 29.9459 36H4.94592C2.73678 36 0.945923 34.2091 0.945923 32Z"
          fill={resolveAccentColor({ theme, type })}
        />
        {label && type !== TYPES.UNAVAILABLE && (
          <text x="51%" y="55%" dominantBaseline="middle" textAnchor="middle">
            <tspan fontSize="14px" fill={resolveTextColor({ theme, type })}>
              {label}
            </tspan>
          </text>
        )}
        {label && type === TYPES.UNAVAILABLE && (
          <>
            <mask
              id={randomCloseIconId}
              mask-type="alpha"
              maskUnits="userSpaceOnUse"
              x="11"
              y="13"
              width="10"
              height="10"
            >
              <path
                d="M20.2412 13.7501C20.505 14.0135 20.5053 14.4409 20.2419 14.7047L17.1645 17.786C17.0476 17.9031 17.0476 18.0929 17.1645 18.21L20.2419 21.2916C20.4834 21.5334 20.5032 21.9127 20.3017 22.1771L20.2412 22.2462C19.9774 22.5096 19.55 22.5093 19.2866 22.2455L16.2112 19.1654C16.0941 19.0481 15.9041 19.048 15.7869 19.1651C15.7868 19.1652 15.7866 19.1653 15.7865 19.1654L12.7122 22.2455C12.4488 22.5093 12.0214 22.5096 11.7576 22.2462C11.4938 21.9828 11.4935 21.5554 11.7569 21.2916L14.8339 18.21C14.9509 18.0928 14.9509 17.9031 14.8339 17.786L11.7569 14.7047C11.5155 14.4629 11.4956 14.0836 11.6972 13.8192L11.7576 13.7501C12.0214 13.4867 12.4488 13.487 12.7122 13.7508L15.7866 16.8299C15.9036 16.9471 16.0936 16.9473 16.2108 16.8302C16.2109 16.8301 16.211 16.83 16.2111 16.8299L19.2866 13.7508C19.55 13.487 19.9774 13.4867 20.2412 13.7501Z"
                fill="white"
              />
            </mask>
            <g mask={`url(#${randomCloseIconId})`} transform="translate(1.1, 0)">
              <path
                d="M20.2412 13.7501C20.505 14.0135 20.5053 14.4409 20.2419 14.7047L17.1645 17.786C17.0476 17.9031 17.0476 18.0929 17.1645 18.21L20.2419 21.2916C20.4834 21.5334 20.5032 21.9127 20.3017 22.1771L20.2412 22.2462C19.9774 22.5096 19.55 22.5093 19.2866 22.2455L16.2112 19.1654C16.0941 19.0481 15.9041 19.048 15.7869 19.1651C15.7868 19.1652 15.7866 19.1653 15.7865 19.1654L12.7122 22.2455C12.4488 22.5093 12.0214 22.5096 11.7576 22.2462C11.4938 21.9828 11.4935 21.5554 11.7569 21.2916L14.8339 18.21C14.9509 18.0928 14.9509 17.9031 14.8339 17.786L11.7569 14.7047C11.5155 14.4629 11.4956 14.0836 11.6972 13.8192L11.7576 13.7501C12.0214 13.4867 12.4488 13.487 12.7122 13.7508L15.7866 16.8299C15.9036 16.9471 16.0936 16.9473 16.2108 16.8302C16.2109 16.8301 16.211 16.83 16.2111 16.8299L19.2866 13.7508C19.55 13.487 19.9774 13.4867 20.2412 13.7501Z"
                fill="black"
              />
              <path d="M25 9H7V27.75H25V9Z" fill={theme.orbit.paletteInkLightHover} />
            </g>
          </>
        )}
      </>
    );
  }

  return selected ? (
    <>
      <path
        d="M0 18C0 12.4772 4.47715 8 10 8H36C41.5228 8 46 12.4772 46 18V50C46 52.2091 44.2091 54 42 54H4C1.79086 54 0 52.2091 0 50V18Z"
        fill={resolveFillColor({ type, theme, selected })}
      />
      <mask
        id={randomIdSelectedNormal}
        maskUnits="userSpaceOnUse"
        x="29.9996"
        y="0.000396729"
        width="24"
        height="24"
        fill="black"
      >
        <rect fill={theme.orbit.paletteWhite} x="29.9996" y="0.000396729" width="24" height="24" />
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M41.9996 2.0004C47.4996 2.0004 51.9996 6.5004 51.9996 12.0004C51.9996 17.5004 47.4996 22.0004 41.9996 22.0004C36.4996 22.0004 31.9996 17.5004 31.9996 12.0004C31.9996 6.5004 36.4996 2.0004 41.9996 2.0004ZM46.6555 7.33313C46.3038 6.98192 45.7339 6.98234 45.3827 7.33407L42.2821 10.4394L42.2188 10.4911C42.0635 10.5935 41.8525 10.5762 41.7159 10.4394L38.6169 7.33407C38.2657 6.98234 37.6958 6.98192 37.3441 7.33313L37.2635 7.42524C36.9947 7.7778 37.0212 8.2835 37.3431 8.60592L40.446 11.7144C40.6018 11.8706 40.6018 12.1234 40.446 12.2796L37.3431 15.3885C36.9919 15.7402 36.9923 16.3101 37.3441 16.6613C37.6958 17.0125 38.2657 17.0121 38.6169 16.6603L41.7159 13.5538C41.8729 13.3971 42.1261 13.3974 42.2822 13.5537L45.3827 16.6603C45.7339 17.0121 46.3038 17.0125 46.6555 16.6613L46.7361 16.5692C47.0049 16.2166 46.9784 15.7109 46.6564 15.3885L43.5531 12.2796C43.3972 12.1234 43.3972 11.8706 43.5531 11.7144L46.6564 8.60592C47.0077 8.25419 47.0072 7.68434 46.6555 7.33313Z"
        />
      </mask>
      {label && type !== TYPES.UNAVAILABLE && (
        <text x="42.5%" y="62%" dominantBaseline="middle" textAnchor="middle">
          <tspan fontWeight="bold" fontSize="16px" fill={theme.orbit.paletteWhite}>
            {label}
          </tspan>
        </text>
      )}
      <path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M41.9996 2.0004C47.4996 2.0004 51.9996 6.5004 51.9996 12.0004C51.9996 17.5004 47.4996 22.0004 41.9996 22.0004C36.4996 22.0004 31.9996 17.5004 31.9996 12.0004C31.9996 6.5004 36.4996 2.0004 41.9996 2.0004ZM46.6555 7.33313C46.3038 6.98192 45.7339 6.98234 45.3827 7.33407L42.2821 10.4394L42.2188 10.4911C42.0635 10.5935 41.8525 10.5762 41.7159 10.4394L38.6169 7.33407C38.2657 6.98234 37.6958 6.98192 37.3441 7.33313L37.2635 7.42524C36.9947 7.7778 37.0212 8.2835 37.3431 8.60592L40.446 11.7144C40.6018 11.8706 40.6018 12.1234 40.446 12.2796L37.3431 15.3885C36.9919 15.7402 36.9923 16.3101 37.3441 16.6613C37.6958 17.0125 38.2657 17.0121 38.6169 16.6603L41.7159 13.5538C41.8729 13.3971 42.1261 13.3974 42.2822 13.5537L45.3827 16.6603C45.7339 17.0121 46.3038 17.0125 46.6555 16.6613L46.7361 16.5692C47.0049 16.2166 46.9784 15.7109 46.6564 15.3885L43.5531 12.2796C43.3972 12.1234 43.3972 11.8706 43.5531 11.7144L46.6564 8.60592C47.0077 8.25419 47.0072 7.68434 46.6555 7.33313Z"
        fill={resolveCloseFill({ type, theme })}
      />
      <path
        d="M45.3827 7.33407L43.9675 5.9209L43.9674 5.92095L45.3827 7.33407ZM42.2821 10.4394L43.5472 11.9885L43.6257 11.9244L43.6974 11.8526L42.2821 10.4394ZM42.2188 10.4911L43.3191 12.1613L43.4046 12.1049L43.4839 12.0402L42.2188 10.4911ZM41.7159 10.4394L40.3003 11.8522L41.7159 10.4394ZM38.6169 7.33407L40.0325 5.92128L40.0321 5.9209L38.6169 7.33407ZM37.3441 7.33313L35.9309 5.91787L35.8834 5.96536L35.8391 6.01592L37.3441 7.33313ZM37.2635 7.42524L35.7585 6.10803L35.7139 6.15896L35.6729 6.2128L37.2635 7.42524ZM37.3431 8.60592L38.7586 7.19301L38.7584 7.19275L37.3431 8.60592ZM40.446 11.7144L41.8615 10.3015L40.446 11.7144ZM40.446 12.2796L39.0304 10.8667H39.0304L40.446 12.2796ZM37.3431 15.3885L38.7584 16.8017L38.7587 16.8013L37.3431 15.3885ZM38.6169 16.6603L40.0321 18.0735L40.0328 18.0728L38.6169 16.6603ZM41.7159 13.5538L40.303 12.1382L40.3 12.1413L41.7159 13.5538ZM42.2822 13.5537L43.6978 12.1409V12.1409L42.2822 13.5537ZM45.3827 16.6603L43.9671 18.0732L43.9675 18.0735L45.3827 16.6603ZM46.6555 16.6613L48.0687 18.0765L48.1162 18.029L48.1605 17.9785L46.6555 16.6613ZM46.7361 16.5692L48.2411 17.8864L48.2857 17.8354L48.3267 17.7816L46.7361 16.5692ZM46.6564 15.3885L45.241 16.8014L45.2412 16.8017L46.6564 15.3885ZM43.5531 12.2796L44.9686 10.8667L43.5531 12.2796ZM43.5531 11.7144L44.9685 13.1274L43.5531 11.7144ZM46.6564 8.60592L45.2412 7.19275L45.2411 7.19288L46.6564 8.60592ZM41.9996 4.0004C46.395 4.0004 49.9996 7.60497 49.9996 12.0004H53.9996C53.9996 5.39583 48.6042 0.000396729 41.9996 0.000396729V4.0004ZM49.9996 12.0004C49.9996 16.3958 46.395 20.0004 41.9996 20.0004V24.0004C48.6042 24.0004 53.9996 18.605 53.9996 12.0004H49.9996ZM41.9996 20.0004C37.6042 20.0004 33.9996 16.3958 33.9996 12.0004H29.9996C29.9996 18.605 35.395 24.0004 41.9996 24.0004V20.0004ZM33.9996 12.0004C33.9996 7.60497 37.6042 4.0004 41.9996 4.0004V0.000396729C35.395 0.000396729 29.9996 5.39583 29.9996 12.0004H33.9996ZM48.0687 5.91787C46.9353 4.78619 45.0991 4.78755 43.9675 5.9209L46.798 8.74724C46.3687 9.17713 45.6722 9.17765 45.2423 8.74839L48.0687 5.91787ZM43.9674 5.92095L40.8668 9.02631L43.6974 11.8526L46.798 8.7472L43.9674 5.92095ZM41.0171 8.89035L40.9538 8.94204L43.4839 12.0402L43.5472 11.9885L41.0171 8.89035ZM41.1185 8.82101C41.7407 8.41113 42.5837 8.47763 43.1316 9.02657L40.3003 11.8522C41.1212 12.6747 42.3863 12.7758 43.3191 12.1613L41.1185 8.82101ZM43.1316 9.02657L40.0325 5.92128L37.2012 8.74686L40.3003 11.8522L43.1316 9.02657ZM40.0321 5.9209C38.9004 4.78755 37.0643 4.78619 35.9309 5.91787L38.7572 8.74839C38.3274 9.17765 37.6309 9.17713 37.2016 8.74724L40.0321 5.9209ZM35.8391 6.01592L35.7585 6.10803L38.7684 8.74244L38.8491 8.65034L35.8391 6.01592ZM35.6729 6.2128C34.8057 7.35041 34.8893 8.97902 35.9279 10.0191L38.7584 7.19275C39.153 7.58798 39.1837 8.20519 38.8541 8.63767L35.6729 6.2128ZM35.9276 10.0188L39.0304 13.1273L41.8615 10.3015L38.7586 7.19301L35.9276 10.0188ZM39.0304 13.1273C38.407 12.5028 38.407 11.4914 39.0304 10.8667L41.8616 13.6924C42.7967 12.7555 42.7966 11.2384 41.8615 10.3015L39.0304 13.1273ZM39.0304 10.8667L35.9275 13.9757L38.7587 16.8013L41.8616 13.6924L39.0304 10.8667ZM35.9279 13.9753C34.7962 15.1087 34.7976 16.9448 35.9309 18.0765L38.7572 15.246C39.1871 15.6753 39.1877 16.3718 38.7584 16.8017L35.9279 13.9753ZM35.9309 18.0765C37.0643 19.2082 38.9004 19.2069 40.0321 18.0735L37.2016 15.2472C37.6309 14.8173 38.3274 14.8168 38.7572 15.246L35.9309 18.0765ZM40.0328 18.0728L43.1318 14.9663L40.3 12.1413L37.2009 15.2478L40.0328 18.0728ZM43.1287 14.9694C42.5059 15.591 41.4928 15.594 40.8666 14.9666L43.6978 12.1409C42.7594 11.2007 41.2398 11.2033 40.303 12.1382L43.1287 14.9694ZM40.8666 14.9666L43.9671 18.0732L46.7983 15.2475L43.6978 12.1409L40.8666 14.9666ZM43.9675 18.0735C45.0991 19.2069 46.9353 19.2082 48.0687 18.0765L45.2423 15.246C45.6722 14.8168 46.3687 14.8173 46.798 15.2472L43.9675 18.0735ZM48.1605 17.9785L48.2411 17.8864L45.2311 15.252L45.1505 15.3441L48.1605 17.9785ZM48.3267 17.7816C49.1939 16.644 49.1102 15.0154 48.0717 13.9753L45.2412 16.8017C44.8465 16.4064 44.8159 15.7892 45.1455 15.3567L48.3267 17.7816ZM48.0719 13.9755L44.9686 10.8667L42.1376 13.6926L45.241 16.8014L48.0719 13.9755ZM44.9686 10.8667C45.5921 11.4913 45.5921 12.5028 44.9685 13.1274L42.1377 10.3014C41.2024 11.2383 41.2024 12.7556 42.1376 13.6926L44.9686 10.8667ZM44.9685 13.1274L48.0718 10.019L45.2411 7.19288L42.1377 10.3014L44.9685 13.1274ZM48.0717 10.0191C49.2034 8.88574 49.202 7.04956 48.0687 5.91787L45.2423 8.74839C44.8124 8.31913 44.8119 7.62265 45.2412 7.19275L48.0717 10.0191Z"
        fill={theme.orbit.paletteWhite}
        mask={`url(#${randomIdSelectedNormal}`}
      />
    </>
  ) : (
    <>
      <path
        d="M1.19617 10C1.19617 5.02944 5.2256 1 10.1962 1H36.1962C41.1667 1 45.1962 5.02944 45.1962 10V42C45.1962 43.6569 43.853 45 42.1962 45H4.19617C2.53931 45 1.19617 43.6569 1.19617 42V10Z"
        fill={resolveFillColor({ type, theme, selected })}
        stroke={resolveAccentColor({ type, theme })}
        strokeWidth="2"
      />
      <path
        d="M0.196167 40.8889H46.1962V42C46.1962 44.2092 44.4053 46 42.1962 46H4.19617C1.98703 46 0.196167 44.2092 0.196167 42V40.8889Z"
        fill={resolveAccentColor({ theme, type })}
      />
      {label && type !== TYPES.UNAVAILABLE && (
        <text x="48%" y="53%" dominantBaseline="middle" textAnchor="middle">
          <tspan fontSize="16px" fill={resolveTextColor({ type, theme })}>
            {label}
          </tspan>
        </text>
      )}
      {label && type === TYPES.UNAVAILABLE && (
        <path
          d="M28.6555 17.3331C29.0072 17.6844 29.0077 18.2542 28.6564 18.6059L24.5533 22.7144C24.3973 22.8705 24.3973 23.1235 24.5533 23.2797L28.6564 27.3885C28.9784 27.7109 29.0049 28.2166 28.7361 28.5692L28.6555 28.6613C28.3038 29.0125 27.7339 29.0121 27.3827 28.6603L23.2821 24.5535C23.1258 24.397 22.8722 24.3971 22.7159 24.5536L18.6169 28.6603C18.2657 29.0121 17.6958 29.0125 17.3441 28.6613C16.9923 28.3101 16.9919 27.7402 17.3431 27.3885L21.4458 23.2796C21.6017 23.1235 21.6017 22.8705 21.4458 22.7144L17.3431 18.6059C17.0212 18.2835 16.9947 17.7778 17.2635 17.4252L17.3441 17.3331C17.6958 16.9819 18.2657 16.9823 18.6169 17.3341L22.716 21.4396C22.8722 21.596 23.1258 21.5961 23.2821 21.4396L27.3827 17.3341C27.7339 16.9823 28.3038 16.9819 28.6555 17.3331Z"
          fill={theme.orbit.paletteInkLighterHover}
        />
      )}
    </>
  );
};

export default SeatItem;
